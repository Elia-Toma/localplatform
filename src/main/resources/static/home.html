<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valorizzazione territorio Comunale</title>
</head>

<style>
    form {
        border: 3px solid #f1f1f1;
    }

    /* Full-width inputs */
    input[type=text], input[type=date] {
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }

    /* Set a style for all buttons */
    button {
        background-color: #0441aa;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        cursor: pointer;
        width: 100%;
    }

    /* Add a hover effect for buttons */
    button:hover {
        opacity: 0.8;
    }
</style>
<body>


<h1>Valorizzazione del territorio Comunale</h1>

<h2>Lista Punti d'Interesse</h2>
<ul id="POIlist"></ul>
<button onclick="getPOIs()"> Lista dei POI</button>

<h2>Lista Itinerari</h2>
<ul id="ItinerariesList"></ul>
<button onclick="getItineraries()"> Lista degli itinerari</button>

<h2>Lista Contenuti Generali</h2>
<ul id="GeneralContentsList"></ul>
<button onclick="getGeneralContents()"> Lista dei contenuti generali</button>

<h2>Comune di interesse</h2>
<label for="name">Nome</label>
<input type="text" id="name">
<lable for="Provincia">Provincia</lable>
<input type="text" id="Provincia">
<button onclick="findMunicipal()">Crea cerca</button>


<!-- OpenLayers library -->
<script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>
<!-- Leaflet library -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<!-- HTML container for the map -->
<body>
<!-- HTML container for the map -->


<!-- Input field for latitude -->
<label for="latitude">Latitude:</label>
<input type="text" id="latitude" placeholder="Enter latitude">

<!-- Input field for longitude -->
<label for="longitude">Longitude:</label>
<input type="text" id="longitude" placeholder="Enter longitude">
<div id="map" style="width: 100%; height: 400px;"></div>

<!-- Button to set marker based on input -->
<button onclick="setMarker()">Set Marker</button>

<!-- Leaflet library -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Your JavaScript code for the map and mobile marker -->
<script>
    var map = L.map('map').setView([0, 0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors',
    }).addTo(map);

    var mobileIcon = L.icon({
        iconUrl: 'https://th.bing.com/th/id/OIP.HSUt0EhnxjyNWHKF7frcjwHaHk?w=203&h=207&c=7&r=0&o=5&dpr=1.3&pid=1.7',
        iconSize: [30, 30],
        iconAnchor: [15, 30],
        popupAnchor: [0, -30],
    });

    var mobileMarker = L.marker([0, 0], {icon: mobileIcon}).addTo(map);

    function setMarker() {
        var latitude = parseFloat(document.getElementById('latitude').value);
        var longitude = parseFloat(document.getElementById('longitude').value);

        if (!isNaN(latitude) && !isNaN(longitude)) {
            mobileMarker.setLatLng([latitude, longitude]);
            map.setView([latitude, longitude], 12);
        } else {
            alert('Invalid coordinates. Please enter valid numbers.');
        }
    }
</script>
</body>


<h2>Creazione POI</h2>
<label for="title">Titolo</label>
<input type="text" id="title">
<label for="description">Descrizione</label>
<input type="text" id="description">
<!-- Input field for latitude -->
<label for="latitude">Latitude:</label>
<input type="text" id="POILatitude" placeholder="Enter latitude">
<!-- Input field for longitude -->
<label for="longitude">Longitude:</label>
<input type="text" id="POILongitude" placeholder="Enter longitude">
<button onclick="createPOI()">Crea POI</button>

<h2>Creazione Itinerario</h2>
<label for="ItineraryTitle">Titolo</label>
<input type="text" id="ItineraryTitle">
<label for="ItineraryDescription">Descrizione</label>
<input type="text" id="ItineraryDescription">
<button onclick="createItinerary()">Crea Itinerario</button>

<h2>Creazione Contenuto Generale</h2>
<label for="GeneralContentText">Testo</label>
<input type="text" id="GeneralContentText">
<button onclick="createGeneralContent()">Crea Contenuto Generale</button>

<h2>Update POI</h2>


<h2>Cancellazione POI</h2>
<label for="CancellazionePOI">Cancellazione del POI:</label>
<input type="text" id="CancellazionePOI">
<button onclick="deletePOI()">Cancella POI</button>

<h2>Cerca punto d'interesse dal nome</h2>
<label for="CercaPOI">Cerca POI:</label>
<input type="text" id="CercaPOI">
<button onclick="findPOI()">Cerca POI</button>


<script>
    const baseUrl = 'http://localhost:8080';

    function getPOIs() {
        fetch(`${baseUrl}/POIs`)
            .then(response => response.json())  // Modifica qui per ricevere un array
            .then(data => {
                const list = document.getElementById("POIlist");
                data.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item;  // Modifica qui per stampare la stringa
                    list.appendChild(li);
                });
            })
            .catch(error => console.error('Error', error));
    }

    function getItineraries() {
        fetch(`${baseUrl}/Itineraries`)
            .then(response => response.json())  // Modifica qui per ricevere un array
            .then(data => {
                const list = document.getElementById("ItinerariesList");
                data.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item;  // Modifica qui per stampare la stringa
                    list.appendChild(li);
                });
            })
            .catch(error => console.error('Error', error));
    }

    function getGeneralContents() {
        fetch(`${baseUrl}/GeneralContents`)
            .then(response => response.json())  // Modifica qui per ricevere un array
            .then(data => {
                const list = document.getElementById("GeneralContentsList");
                data.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item;  // Modifica qui per stampare la stringa
                    list.appendChild(li);
                });
            })
            .catch(error => console.error('Error', error));
    }

    function createPOI() {
        const title = document.getElementById("title").value;
        const description = document.getElementById("description").value;
        const POILatitude = parseFloat(document.getElementById("POILatitude").value);
        const POILongitude = parseFloat(document.getElementById("POILongitude").value);

        const POIArray = [title, description, POILatitude, POILongitude];

        fetch(`${baseUrl}/AggiungiPOI`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(POIArray),
        })
            .then(response => response.text())
            .then(data => {
                console.log('POI creato con successo:', data);
            })
            .catch((error) => {
                console.error('POI non creato:', error);
            });
    }

    function createItinerary() {
        const ItineraryTitle = document.getElementById("ItineraryTitle").value;
        const ItineraryDescription = document.getElementById("ItineraryDescription").value;

        const ItineraryArray = [ItineraryTitle, ItineraryDescription];

        fetch(`${baseUrl}/AggiungiItinerario`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(ItineraryArray),
        })
            .then(response => response.text())
            .then(data => {
                console.log('Itinerario creato con successo:', data);
            })
            .catch((error) => {
                console.error('Itinerario non creato:', error);
            });
    }

    function createGeneralContent() {
        const GeneralContentText = document.getElementById("GeneralContentText").value;

        fetch(`${baseUrl}/AggiungiContenutoGenerale`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(GeneralContentText),
        })
            .then(response => response.text())
            .then(data => {
                console.log('Contenuto generale creato con successo:', data);
            })
            .catch((error) => {
                console.error('Contenuto generale non creato:', error);
            });
    }

    function deletePOI() {
        const CancellazionePOI = document.getElementById("CancellazionePOI").value;
        fetch(`${baseUrl}/POI/${CancellazionePOI}`, {
            method: 'DELETE',
        })
            .then(response => response.json())
            .then(data => {
                console.log('POI cancellato con successo:', data);
                getPOI();
            })
            .catch((error) => {
                console.error('POI non cancellato:', error);
            });
    }

    function findPOI() {
        const CercaPOI = document.getElementById("CercaPOI").value;
        fetch(`${baseUrl}/POI/${CercaPOI}`)
            .then(response => response.json())
            .then(data => {
                console.log('POI trovato con successo:', data);
                getPOI();
            })
            .catch((error) => {
                console.error('POI non trovato:', error);
            });
    }
</script>
